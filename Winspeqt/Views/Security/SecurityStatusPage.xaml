<Page
    x:Class="Winspeqt.Views.Security.SecurityStatusPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:helpers="using:Winspeqt.Helpers"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <helpers:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Page.Resources>

    <ScrollViewer>
        <Grid Padding="60">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid Grid.Row="0" Margin="0,0,0,32">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Button 
                    Grid.Column="0"
                    Content="â† Back"
                    Click="BackButton_Click"
                    Background="Transparent"
                    BorderThickness="0"
                    FontSize="16"
                    Margin="0,0,20,0"/>

                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock 
                        Text="Security Status Check" 
                        FontSize="36" 
                        FontWeight="Bold"/>
                    <TextBlock 
                        Text="Check the health of your PC's security features" 
                        FontSize="18" 
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        Margin="0,4,0,0"/>
                </StackPanel>

                <Button 
                    Grid.Column="2"
                    Content="ðŸ”„ Refresh"
                    Command="{Binding RefreshCommand}"
                    FontSize="16"
                    Padding="16,8"/>
            </Grid>

            <!-- Overall Security Score -->
            <Border 
                Grid.Row="1"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="2"
                CornerRadius="16"
                Padding="40"
                Margin="0,0,0,32">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Score Circle -->
                    <Grid Grid.Column="0" Width="120" Height="120" Margin="0,0,40,0">
                        <Ellipse 
                            Fill="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                            Stroke="{Binding OverallScoreColor, Mode=OneWay}"
                            StrokeThickness="8"/>
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock 
                                Text="{Binding OverallScore, Mode=OneWay}" 
                                FontSize="42" 
                                FontWeight="Bold"
                                HorizontalAlignment="Center"
                                Foreground="{Binding OverallScoreColor, Mode=OneWay}"/>
                            <TextBlock 
                                Text="/ 100" 
                                FontSize="18"
                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Grid>

                    <!-- Overall Status -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock 
                            Text="Overall Security Health" 
                            FontSize="24" 
                            FontWeight="SemiBold"
                            Margin="0,0,0,12"/>
                        <TextBlock 
                            Text="{Binding OverallStatus, Mode=OneWay}" 
                            FontSize="20"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            TextWrapping="Wrap"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Security Components Grid -->
            <Grid Grid.Row="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Windows Defender Card -->
                <Border 
                    Grid.Row="0" Grid.Column="0"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="2"
                    CornerRadius="12"
                    Padding="28"
                    Margin="0,0,12,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock 
                                Text="ðŸ›¡ï¸" 
                                FontSize="28"
                                Margin="0,0,12,0"/>
                            <TextBlock 
                                Text="Windows Defender" 
                                FontSize="22" 
                                FontWeight="SemiBold"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock 
                                Text="{Binding DefenderStatus.Icon, Mode=OneWay}" 
                                FontSize="32"
                                Foreground="{Binding DefenderStatus.Color, Mode=OneWay}"
                                Margin="0,0,12,0"/>
                            <TextBlock 
                                Text="{Binding DefenderStatus.Status, Mode=OneWay}" 
                                FontSize="24" 
                                FontWeight="SemiBold"
                                Foreground="{Binding DefenderStatus.Color, Mode=OneWay}"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock 
                            Text="{Binding DefenderStatus.Message, Mode=OneWay}" 
                            FontSize="15"
                            TextWrapping="Wrap"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            LineHeight="22"
                            Margin="0,0,0,12"/>

                        <Button 
                            Content="ðŸ”§ Open Windows Security"
                            Click="OpenDefenderSettings_Click"
                            HorizontalAlignment="Stretch"
                            Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Firewall Card -->
                <Border 
                    Grid.Row="0" Grid.Column="1"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="2"
                    CornerRadius="12"
                    Padding="28"
                    Margin="12,0,0,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock 
                                Text="ðŸ”¥" 
                                FontSize="28"
                                Margin="0,0,12,0"/>
                            <TextBlock 
                                Text="Windows Firewall" 
                                FontSize="22" 
                                FontWeight="SemiBold"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock 
                                Text="{Binding FirewallStatus.Icon, Mode=OneWay}" 
                                FontSize="32"
                                Foreground="{Binding FirewallStatus.Color, Mode=OneWay}"
                                Margin="0,0,12,0"/>
                            <TextBlock 
                                Text="{Binding FirewallStatus.Status, Mode=OneWay}" 
                                FontSize="24" 
                                FontWeight="SemiBold"
                                Foreground="{Binding FirewallStatus.Color, Mode=OneWay}"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock 
                            Text="{Binding FirewallStatus.Message, Mode=OneWay}" 
                            FontSize="15"
                            TextWrapping="Wrap"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            LineHeight="22"
                            Margin="0,0,0,12"/>

                        <Button 
                            Content="ðŸ”§ Open Firewall Settings"
                            Click="OpenFirewallSettings_Click"
                            HorizontalAlignment="Stretch"
                            Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Windows Update Card -->
                <Border 
                    Grid.Row="1" Grid.Column="0"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="2"
                    CornerRadius="12"
                    Padding="28"
                    Margin="0,12,12,0">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock 
                                Text="ðŸ”„" 
                                FontSize="28"
                                Margin="0,0,12,0"/>
                            <TextBlock 
                                Text="Windows Update" 
                                FontSize="22" 
                                FontWeight="SemiBold"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock 
                                Text="{Binding UpdateStatus.Icon, Mode=OneWay}" 
                                FontSize="32"
                                Foreground="{Binding UpdateStatus.Color, Mode=OneWay}"
                                Margin="0,0,12,0"/>
                            <TextBlock 
                                Text="{Binding UpdateStatus.Status, Mode=OneWay}" 
                                FontSize="24" 
                                FontWeight="SemiBold"
                                Foreground="{Binding UpdateStatus.Color, Mode=OneWay}"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock 
                            Text="{Binding UpdateStatus.Message, Mode=OneWay}" 
                            FontSize="15"
                            TextWrapping="Wrap"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            LineHeight="22"
                            Margin="0,0,0,12"/>

                        <Button 
                            Content="ðŸ”§ Open Windows Update"
                            Click="OpenWindowsUpdate_Click"
                            HorizontalAlignment="Stretch"
                            Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>

                <!-- BitLocker Card -->
                <Border 
                    Grid.Row="1" Grid.Column="1"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="2"
                    CornerRadius="12"
                    Padding="28"
                    Margin="12,12,0,0">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock 
                                Text="ðŸ”" 
                                FontSize="28"
                                Margin="0,0,12,0"/>
                            <TextBlock 
                                Text="BitLocker Encryption" 
                                FontSize="22" 
                                FontWeight="SemiBold"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock 
                                Text="{Binding BitLockerStatus.Icon, Mode=OneWay}" 
                                FontSize="32"
                                Foreground="{Binding BitLockerStatus.Color, Mode=OneWay}"
                                Margin="0,0,12,0"/>
                            <TextBlock 
                                Text="{Binding BitLockerStatus.Status, Mode=OneWay}" 
                                FontSize="24" 
                                FontWeight="SemiBold"
                                Foreground="{Binding BitLockerStatus.Color, Mode=OneWay}"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock 
                            Text="{Binding BitLockerStatus.Message, Mode=OneWay}" 
                            FontSize="15"
                            TextWrapping="Wrap"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            LineHeight="22"
                            Margin="0,0,0,12"/>

                        <Button 
                            Content="ðŸ”§ Open Encryption Settings"
                            Click="OpenBitLockerSettings_Click"
                            HorizontalAlignment="Stretch"
                            Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Loading Overlay -->
            <Border
                Grid.Row="0" 
                Grid.RowSpan="3"
                Background="#CC000000"
                Visibility="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                <ProgressBar 
                    Value="{x:Bind ViewModel.LoadingProgress, Mode=OneWay}"
                    Maximum="100"
                    Width="300"
                    Height="6"/>
            </Border>
        </Grid>
    </ScrollViewer>
</Page>